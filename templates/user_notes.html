{% extends 'base.html' %}
{% block title %}{{user.username}}'s Notes{% endblock %}

{% block body %}
  <div class="row" id="user-options">
    <div class="row">
      <div class="col-2"></div>
      <div class="col-7" id="search-col">
        <!-- Feature: Keyword Search -->
        <form action="/search" id="search-option">
          <div class="input-group mb-3">
            <input class="form-control" type="search" name="search" id="search-bar">
            <div class="input-group-append">
              <button class="btn btn-outline-secondary option-btn" id="search-button">Seach Keyword</button>
            </div>
          </div>
        </form>
      </div>
      <div class="col-1"></div>
      <div class="col">
        <form action="/logout" id="logout-option">
          <button class="btn btn-outline-secondary option-btn" type="submit" id="logout-button">Log Out</button>
        </form>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6" align="right">
        <!-- Feature: Note Creation Modal -->
        <button class="btn btn-outline-secondary option-btn" id="create-note-button">Create a Note</button>

        <div class="modal-box" id="modal-box">
          <form action="/create-note" method="POST" enctype="multipart/form-data">
            <div class="modal-content" id="modal-content" align="left">
              <div class="modal-header">
                <h2>Create a Note</h2>
              </div>
              <div class="modal-body">
                <p>
                    Title<br/>
                    <input type='text' name="title">
                </p>
                <p id="note-body">
                    Body<br/>
                    <textarea type="text" name="body" id="text-body" style="width: 100%"></textarea>
                </p>
                <p id="image-note-upload"></p>
                <p id="image-attachment-upload"></p>
                <p align="right">
                    <button class="btn btn-outline-secondary option-btn" id="image-note-btn">Upload Image as Note</button>
                    <button class="btn btn-outline-secondary option-btn" id="image-attachment-btn">Attach Image to Note</button>
                </p>
              </div>
              <div class="modal-footer">
                <button class="btn btn-outline-secondary save" id="save-button">Save</button>
                <button class="btn btn-outline-secondary cancel" id="cancel-button">Cancel</button>
              </div>
            </div>
          </form>
        </div>
      </div>
      <div class="col-sm-12 col-md-6" id="sort-col">
        <!-- Feature: Sort Filters -->
        <form action="/sort-by" id="sort-option">
          <div class="input-group">
            <select class="custom-select" name="sort-by" id="sort-by-select">
              <option value="title-asc">Title, ascending</option>
              <option value="title-desc">Title, descending</option>
              <option value="date-created-asc" selected>Date Created, old to new</option>
              <option value="date-created-desc">Date Created, new to old</option>
              <option value="date-modified-asc">Date Modified, old to new</option>
              <option value="date-modified-desc">Date Modified, new to old</option>
            </select>
            <div class="input-group-append">
              <button class="btn btn-outline-secondary option-btn" id="sort-button">Sort</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <section id="note-container">
    <div class="row">
      {% if not notes %}
      <p align="center" style="margin-top: 25px"><em>You currently have no notes.</em></p>
      {% endif %}
      {% for note in notes %}
      <div class="col-sm-6 col-md-4 col-lg-3">
        <form action="/view-note/{{ note.note_id }}">
        <button class="note">
          {% if note.title %}
            <h2 class="note-title">{{ note.title }}</h2>
          {% endif %}

          {% if note.body %}
            {% if "/digitalbraindump/image/upload/" in note.body %}
              <p><img class="img-page" src="{{ note.body }}"></img></p>
            {% else %}
              <p class="note-body">{{ note.body }}</p>
            {% endif %}
          {% endif %}

          {% if note.image %}
            <img class="img-page" src="{{ note.image }}"></img>
          {% endif %}
        </button>
        </form>
      </div>
      {% endfor %}
    </div>
  </section>
{% endblock %}

{% block js %}
<script src="/static/js/search_filter.js"></script>
<script src="/static/js/modal.js"></script>
<script src="/static/js/image_upload.js"></script>
{% endblock %}

